function e(e,t,l,n){Object.defineProperty(e,t,{get:l,set:n,enumerable:!0,configurable:!0})}function t(e){return/^[\d.,]+$/g.test(e)}function l(e,t){let l=Math.pow(10,t??1),n=e??0;return(isNaN(n)||!isFinite(n))&&(n=0),Math.round(n*l)/l}function n(e){let t=[];if(!e||"string"!=typeof e)return t;let l=e.split(/(\r\n|\n\r|\n){2,}/gm);for(let e=0;e<l.length;e++){let n=l[e].trim();if(!n.length)continue;let r=n.split(/\n/gm).map(e=>e.split(/",/g).map(e=>e.trim().replace(/^(")|(")$/g,"")));t.push(r)}return t}function r(e){return e.indexOf("**PROJ")>-1?3:4}function u(e){return 3==(e.indexOf("**PROJ")>-1?3:4)?function(e){let r=[],u=n(e);for(let e=0;e<u.length;e++){let n="",h=u[e],i=[],g=[];for(let e=0;e<h.length;e++){let r=h[e];if(r.length<1)continue;let u=r[0]??"";if(u.indexOf("**")>-1)n=u.replace(/[?*]/g,"").trim();else if("*"===u.charAt(0))for(let e=0;e<r.length;e++){let t=r[e];i.push({name:t.length?t.replace(/[?*]/g,"").trim():"undefined",unit:"",type:""})}else if("<UNITS>"===u)for(let e=0;e<r.length;e++){let t=r[e];e<i.length&&(i[e].unit=t.length?t.trim():"")}else{let e="<CONT>"===u&&g.length>0,h=[];for(let e=0;e<r.length;e++){let n=r[e],u=n&&n.length?n:"",g=(e<i.length?i[e]:{name:"undefined"}).unit??"";if("dd/mm/yyyy"===g){let e=u.split("/");h.push(3===e.length?`${e[2].trim()}-${e[1].trim()}-${e[0].trim()}`:null)}else if("yyyy-mm-dd"===g){let e=u.split("-");h.push(3===e.length?`${e[0].trim()}-${e[1].trim()}-${e[2].trim()}`:null)}else u.length?t(u)?h.push(l(parseFloat(u.trim()),5)):h.push(u):h.push(null)}if(e){let e=g[g.length-1];for(let t=1;t<h.length;t++){let l=h[t]??"";null!==l&&t<e.length&&(e[t]=`${e[t]??""}${l}`)}}else{if(i.length<h.length)for(;i.length<h.length;)i.push({name:`${n}_${i.length}`,unit:"",type:""});if(h.length<i.length)for(;h.length<i.length;)h.push(null);g.push(h)}}}n.length&&r.push({heading:n,columns:i,rows:g})}return r}(e):function(e){let r=[],u=n(e);for(let e=0;e<u.length;e++){let n="",h=u[e],i=[],g=[];for(let e=0;e<h.length;e++){let r=h[e];if(r.length<2)continue;let u=r[0]??"";if("GROUP"===u)n=(r[1]??"").trim();else if("HEADING"===u)for(let e=1;e<r.length;e++){let t=r[e];i.push({name:t.length?t.trim():"undefined",unit:"",type:""})}else if("UNIT"===u)for(let e=1;e<r.length;e++){let t=r[e];e-1<i.length&&(i[e-1].unit=t.length?t.trim():"")}else if("TYPE"===u)for(let e=1;e<r.length;e++){let t=r[e];e-1<i.length&&(i[e-1].type=t.length?t.trim():"")}else if("DATA"===u){let e=[];for(let n=1;n<r.length;n++){let u=r[n],h=u.length?u.trim():"",g=(n-1<i.length?i[n-1]:{name:"undefined"}).type??"";"DT"===g?e.push(/\d{4}-\d{2}-\d{2}/g.test(h)?h:null):"DMS"===g?e.push(h.length?h:null):g.indexOf("DP")>-1||g.indexOf("SP")>1?e.push(h.length?l(Number.parseFloat(h),5):null):"X"===g||"ID"===g?e.push(h.length?h:null):t(h)?e.push(h.length?l(Number.parseFloat(h),5):null):e.push(h.length?h:null)}if(i.length<e.length)for(;i.length<e.length;)i.push({name:`${n}_${i.length}`,unit:"",type:""});if(e.length<i.length)for(;e.length<i.length;)e.push(null);g.push(e)}}n.length&&r.push({heading:n,columns:i,rows:g})}return r}(e)}function h(e,t){if(!t.length)return null;let l=t.findIndex(t=>t.heading===e);return l>-1?t[l]:null}function i(e,t){return e.rows.map(l=>{let n={};return t.forEach(t=>{let r=e.columns.findIndex(e=>e.name===t.header),u=r>-1?l[r]:null;"percent"===t.format?(u=Number.parseFloat(u),n[t.name]=Number.isFinite(u)?u/100:null):n[t.name]=null!==u?u:t.default??null}),n})}e(module.exports,"getVersion",()=>r),e(module.exports,"parse",()=>u),e(module.exports,"find",()=>h),e(module.exports,"map",()=>i);
//# sourceMappingURL=main.js.map
