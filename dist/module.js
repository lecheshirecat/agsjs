function e(e){return/^[\d.,]+$/g.test(e)}function t(e,t){let l=Math.pow(10,t??1),n=e??0;return(isNaN(n)||!isFinite(n))&&(n=0),Math.round(n*l)/l}function l(e){let t=[];if(!e||"string"!=typeof e)return t;let l=e.split(/(\r\n|\n\r|\n){2,}/gm);for(let e=0;e<l.length;e++){let n=l[e].trim();if(!n.length)continue;let h=n.split(/\n/gm).map(e=>e.split(/",/g).map(e=>e.trim().replace(/^(")|(")$/g,"")));t.push(h)}return t}function n(e){return e.indexOf("**PROJ")>-1?3:4}function h(n){return 3==(n.indexOf("**PROJ")>-1?3:4)?function(n){let h=[],r=l(n);for(let l=0;l<r.length;l++){let n="",i=r[l],u=[],g=[];for(let l=0;l<i.length;l++){let h=i[l];if(h.length<1)continue;let r=h[0]??"";if(r.indexOf("**")>-1)n=r.replace(/[?*]/g,"").trim();else if("*"===r.charAt(0))for(let e=0;e<h.length;e++){let t=h[e];u.push({name:t.length?t.replace(/[?*]/g,"").trim():"undefined",unit:"",type:""})}else if("<UNITS>"===r)for(let e=0;e<h.length;e++){let t=h[e];e<u.length&&(u[e].unit=t.length?t.trim():"")}else{let l="<CONT>"===r&&g.length>0,i=[];for(let l=0;l<h.length;l++){let n=h[l],r=n&&n.length?n:"",g=(l<u.length?u[l]:{name:"undefined"}).unit??"";if("dd/mm/yyyy"===g){let e=r.split("/");i.push(3===e.length?`${e[2].trim()}-${e[1].trim()}-${e[0].trim()}`:null)}else if("yyyy-mm-dd"===g){let e=r.split("-");i.push(3===e.length?`${e[0].trim()}-${e[1].trim()}-${e[2].trim()}`:null)}else r.length?e(r)?i.push(t(parseFloat(r.trim()),5)):i.push(r):i.push(null)}if(l){let e=g[g.length-1];for(let t=1;t<i.length;t++){let l=i[t]??"";null!==l&&t<e.length&&(e[t]=`${e[t]??""}${l}`)}}else{if(u.length<i.length)for(;u.length<i.length;)u.push({name:`${n}_${u.length}`,unit:"",type:""});if(i.length<u.length)for(;i.length<u.length;)i.push(null);g.push(i)}}}n.length&&h.push({heading:n,columns:u,rows:g})}return h}(n):function(n){let h=[],r=l(n);for(let l=0;l<r.length;l++){let n="",i=r[l],u=[],g=[];for(let l=0;l<i.length;l++){let h=i[l];if(h.length<2)continue;let r=h[0]??"";if("GROUP"===r)n=(h[1]??"").trim();else if("HEADING"===r)for(let e=1;e<h.length;e++){let t=h[e];u.push({name:t.length?t.trim():"undefined",unit:"",type:""})}else if("UNIT"===r)for(let e=1;e<h.length;e++){let t=h[e];e-1<u.length&&(u[e-1].unit=t.length?t.trim():"")}else if("TYPE"===r)for(let e=1;e<h.length;e++){let t=h[e];e-1<u.length&&(u[e-1].type=t.length?t.trim():"")}else if("DATA"===r){let l=[];for(let n=1;n<h.length;n++){let r=h[n],i=r.length?r.trim():"",g=(n-1<u.length?u[n-1]:{name:"undefined"}).type??"";"DT"===g?l.push(/\d{4}-\d{2}-\d{2}/g.test(i)?i:null):"DMS"===g?l.push(i.length?i:null):g.indexOf("DP")>-1||g.indexOf("SP")>1?l.push(i.length?t(Number.parseFloat(i),5):null):"X"===g||"ID"===g?l.push(i.length?i:null):e(i)?l.push(i.length?t(Number.parseFloat(i),5):null):l.push(i.length?i:null)}if(u.length<l.length)for(;u.length<l.length;)u.push({name:`${n}_${u.length}`,unit:"",type:""});if(l.length<u.length)for(;l.length<u.length;)l.push(null);g.push(l)}}n.length&&h.push({heading:n,columns:u,rows:g})}return h}(n)}function r(e,t){if(!t.length)return null;let l=t.findIndex(t=>t.heading===e);return l>-1?t[l]:null}function i(e,t){return e.rows.map(l=>{let n={};return t.forEach(t=>{let h=e.columns.findIndex(e=>e.name===t.header),r=h>-1?l[h]:null;"percent"===t.format?(r=Number.parseFloat(r),n[t.name]=Number.isFinite(r)?r/100:null):n[t.name]=null!==r?r:t.default??null}),n})}export{n as getVersion,h as parse,r as find,i as map};
//# sourceMappingURL=module.js.map
